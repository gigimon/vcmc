# Step 12: Batch Operations поверх selection

## Цель
Перевести `F5/F6/F8` на пакетные операции по выделенному набору и сделать их безопасными и предсказуемыми.

## Решения
- Если в активной панели есть выделение, `F5/F6/F8` работают по всему набору (иначе по текущему элементу).
- Перед batch-запуском добавлен preflight:
  - виртуальные записи запрещены;
  - проверка дубликатов source;
  - проверка конфликтов destination (включая уже существующие пути);
  - проверка guard-rails для delete (`/`, `$HOME`).
- Перед выполнением показывается сводный confirm с количеством, объемом и рисками.
- Добавлен `batch_id` в `JobRequest/JobUpdate/Job` и агрегатор прогресса:
  - итоговый summary в лог;
  - сводный alert при частичных ошибках.

## Checklist
[x] Изменить `F5/F6/F8` на работу с набором выбранных элементов (если выбор пуст, использовать current).
[x] Добавить preflight-валидацию пакета: виртуальные записи, дубликаты, конфликтные target paths.
[x] Показать сводный confirm перед batch delete/move/copy (кол-во, объем, риски).
[x] Вести агрегированный прогресс/ошибки по пачке в activity log.

## Прогресс
- 2026-02-13: step создан.
- 2026-02-13: `F5/F6/F8` используют batch flow при наличии выделения в активной панели.
- 2026-02-13: реализован preflight для batch copy/move/delete с проверками конфликтов и safety-rules.
- 2026-02-13: добавлен summary confirm перед batch запуском.
- 2026-02-13: добавлен `batch_id` в job-модель и агрегированный batch progress/logging.
- 2026-02-13: `cargo fmt`, `cargo check`, `cargo run -- --smoke` успешно.
